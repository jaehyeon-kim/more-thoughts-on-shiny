<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'/>
<script src="/public/htmlwidgets/htmlwidgets.js"></script>
<!-- need a shared JQuery lib -->
<script src="/public/shared/jquery.min.js"></script>
<!-- DT -->
<link href="/public/datatables/css/datatables-crosstalk.css" rel="stylesheet" />
<script src="/public/datatables/datatables.js"></script>
<link href="/public/datatables/lib/datatables/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="/public/datatables/lib/datatables/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="/public/datatables/lib/datatables/js/jquery.dataTables.min.js"></script>
<!-- highchater -->
<script src="/public/highcharter/lib/proj4js/proj4.js"></script>
<link href="/public/highcharter/lib/highcharts-5.0.6/css/motion.css" rel="stylesheet" />
<script src="/public/highcharter/lib/highcharts-5.0.6/highstock.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/highcharts-3d.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/highcharts-more.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/annotations.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/broken-axis.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/data.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/drilldown.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/exporting.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/funnel.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/heatmap.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/map.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/no-data-to-display.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/offline-exporting.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/solid-gauge.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/modules/treemap.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/plugins/annotations.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/plugins/draggable-legend.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/plugins/draggable-points.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/plugins/export-csv.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/plugins/grouped-categories.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/plugins/motion.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/plugins/pattern-fill-v2.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/plugins/tooltip-delay.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/custom/reset.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/custom/symbols-extra.js"></script>
<script src="/public/highcharter/lib/highcharts-5.0.6/custom/text-symbols.js"></script>
<link href="/public/highcharter/lib/font-awesome-4.5.0/font-awesome.min.css" rel="stylesheet" />
<link href="/public/highcharter/lib/htmlwdgtgrid/htmlwdgtgrid.css" rel="stylesheet" />
<script src="/public/highcharter/highchart.js"></script>
<!-- plotly -->
<script src="/public/plotly/plotly.js"></script>
<script src="/public/plotly/lib/typedarray/typedarray.min.js"></script>
<link href="/public/plotly/lib/plotlyjs/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/public/plotly/lib/plotlyjs/plotly-latest.min.js"></script>
<!-- crosstalk -->
<link href="/public/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/public/crosstalk/js/crosstalk.min.js"></script>
<!-- bootstrap, etc -->
<link href="/public/shared/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="/public/shared/bootstrap/js/bootstrap.min.js"></script>
<script src="/public/shared/bootstrap/shim/html5shiv.min.js"></script>
<script src="/public/shared/bootstrap/shim/respond.min.js"></script>  
</head>
<body>
  <nav class="navbar navbar-default navbar-static-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <span class="navbar-brand">Htmlwidgets + RServe</span>
      </div>
      <ul class="nav navbar-nav" data-tabsetid="6616">
        <li class="active">
          <a href="#tab-6616-1" data-toggle="tab" data-value="Demo">Demo</a>
        </li>
      </ul>
    </div>
  </nav>
  <div class="container-fluid">
    <div class="tab-content" data-tabsetid="6616">
      <div class="tab-pane active" data-value="Demo" id="tab-6616-1">
        <div class="container-fluid">
          <div class="row">
            <div style="height: 400px;">
              <div class="col-sm-2">
                <button id="dt" type="button" class="btn btn-default action-button">update data table</button>
              </div>
              <div class="col-sm-10">
                  <div id="htmlwidget_container_dt_out">
                    <div id="htmlwidget_dt_out" style="width:100%;height:100%;" class="datatables html-widget"></div>
                  </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div style="height: 400px;">
              <div class="col-sm-2">
                <button id="highchart" type="button" class="btn btn-default action-button">update highchart</button>
              </div>
              <div class="col-sm-10">
                  <div id="htmlwidget_container_highchart_out">
                    <div id="htmlwidget_highchart_out" style="width:100%;height:100%;" class="highchart html-widget"></div>
                  </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div style="height: 400px;">
              <div class="col-sm-2">
                <button id="plotly" type="button" class="btn btn-default action-button">update plotly</button>
              </div>
              <div class="col-sm-10">
                  <div id="htmlwidget_container_plotly_out">
                    <div id="htmlwidget_plotly_out" style="width:100%;height:400px;" class="plotly html-widget"></div>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script type="application/htmlwidget-sizing" data-for="htmlwidget_dt_out">{"browser":{"width":"100%","height":400,"padding":40,"fill":true}}</script>
<script type="application/htmlwidget-sizing" data-for="htmlwidget_highchart_out">{"browser":{"width":"100%","height":400,"padding":40,"fill":true}}</script>
<script type="application/htmlwidget-sizing" data-for="htmlwidget_plotly_out">{"browser":{"width":"100%","height":400,"padding":40,"fill":true}}</script>

<script type = "text/javascript" language = "javascript">
    function req(elem, tpe) {
     var btn_id = "#" + elem;
     var widget_id = "#htmlwidget_" + elem + "_out";
     var elem_id = elem + "_out";
     var data_for = "htmlwidget_" + elem + "_out";
     var scr_selector = 'script[type="application/json"][data-for="' + data_for + '"]';
      
     $.support.cors = true;
     $(btn_id).prop("disabled", true);
     $(widget_id).removeClass("html-widget-static-bound");
     $.ajax({
       url: "http://10.74.54.203:8000/widget",
       data: { element_id: elem_id, type: tpe },
       error: function(err) {
         $(btn_id).removeAttr('disabled');
       },
       success: function(data) {
          //console.log(data)
          if($(scr_selector).length == 0) {
            $('body').append(data)
          } else {
            if (elem.includes('plotly')) {
              try {
                //Plotly.deleteTraces(htmlwidget_plotly_out, [0])
                Plotly.purge(data_for);
              }
              catch(err) {
                console.log(err);
              }
            }
            $(scr_selector).replaceWith(data);
          }
          setTimeout(function(){
            window.HTMLWidgets.staticRender();
          }, 500);
          $(btn_id).removeAttr('disabled');
       }
     });      
    }
    
    $(document).ready(function() {
      $("#dt").click(function() {
        req('dt', 'src');
      });
    });
    
    $(document).ready(function() {
      $("#highchart").click(function() {
        req('highchart', 'src');
      });
    });
    
    $(document).ready(function() {
      $("#plotly").click(function() {
        req('plotly', 'src');
      });
    });

</script>


</body>
</html>